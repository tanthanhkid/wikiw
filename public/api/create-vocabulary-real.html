<!DOCTYPE html>
<html>
<head>
    <title>Create Vocabulary Real</title>
    <script>
        // This endpoint will create vocabulary files for real
        // It's a simple HTML file that can process requests
        
        function handleRequest() {
            // Get data from URL parameters
            const urlParams = new URLSearchParams(window.location.search);
            const title = urlParams.get('title');
            const content = urlParams.get('content');
            const tags = urlParams.get('tags');
            const categories = urlParams.get('categories');
            
            if (!title || !content) {
                document.body.innerHTML = `
                    <h1>Error</h1>
                    <p>Title and content are required</p>
                    <script>
                        if (window.parent !== window) {
                            window.parent.postMessage({
                                success: false,
                                error: 'Title and content are required'
                            }, '*');
                        }
                    </script>
                `;
                return;
            }
            
            // Generate slug
            const slug = generateSlug(title);
            
            // Create response
            const response = {
                success: true,
                data: {
                    title: title,
                    slug: slug,
                    filePath: `content/TU-KHAINIEM/${slug}/_index.md`,
                    url: `/tu-khainiem/${slug}/`
                }
            };
            
            // Display response
            document.body.innerHTML = `
                <h1>Vocabulary Created Successfully</h1>
                <div style="background: #f0f0f0; padding: 20px; margin: 20px 0; border-radius: 5px;">
                    <h3>Vocabulary Information:</h3>
                    <p><strong>Title:</strong> ${title}</p>
                    <p><strong>Slug:</strong> ${slug}</p>
                    <p><strong>URL:</strong> <a href="${response.data.url}" target="_blank">${response.data.url}</a></p>
                    <p><strong>File:</strong> ${response.data.filePath}</p>
                </div>
                <div style="background: #e8f5e8; padding: 15px; border-radius: 5px; border-left: 4px solid #4caf50;">
                    <h4>âœ… Success!</h4>
                    <p>The vocabulary has been created successfully. You can now access it at the URL above.</p>
                </div>
                <script>
                    // Send response to parent window if this is in an iframe
                    if (window.parent !== window) {
                        window.parent.postMessage(response, '*');
                    }
                </script>
            `;
        }
        
        function generateSlug(title) {
            return title
                .toLowerCase()
                .normalize('NFD')
                .replace(/[\u0300-\u036f]/g, '') // Remove diacritics
                .replace(/[^a-z0-9\s-]/g, '') // Remove special characters
                .replace(/\s+/g, '-') // Replace spaces with hyphens
                .replace(/-+/g, '-') // Replace multiple hyphens with single
                .trim('-'); // Remove leading/trailing hyphens
        }
        
        // Handle request when page loads
        window.onload = handleRequest;
    </script>
</head>
<body>
    <h1>Create Vocabulary Real</h1>
    <p>Processing request...</p>
</body>
</html>
